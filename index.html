<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üéÖ Secret Santa Scratch Card</title>
  <script>
  const people = [
    {
      name: "Rahul Sharma",
      photo: "https://randomuser.me/api/portraits/men/32.jpg",
      message: "Something cool, fun and thoughtful üòÑ"
    },
    {
      name: "Amit Verma",
      photo: "https://randomuser.me/api/portraits/men/45.jpg",
      message: "Make him smile with a surprise üéâ"
    },
    {
      name: "Rohan Mehta",
      photo: "https://randomuser.me/api/portraits/men/67.jpg",
      message: "Simple gift but full of heart ‚ù§Ô∏è"
    },
    {
      name: "Karan Singh",
      photo: "https://randomuser.me/api/portraits/men/12.jpg",
      message: "Something useful but unexpected üòâ"
    }
  ];

  const budgets = [500, 750, 1000, 1200, 1500];

  const selectedPerson = people[Math.floor(Math.random() * people.length)];
  const selectedBudget = budgets[Math.floor(Math.random() * budgets.length)];

  document.getElementById("photo").src = selectedPerson.photo;
  document.getElementById("name").innerText = selectedPerson.name;
  document.getElementById("budget").innerText = selectedBudget;
  document.getElementById("message").innerText = selectedPerson.message;

  const canvas = document.getElementById("scratch");
  const ctx = canvas.getContext("2d");
  const card = document.querySelector(".card");

  canvas.width = card.offsetWidth;
  canvas.height = card.offsetHeight;

  ctx.fillStyle = "#bdc3c7";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  ctx.fillStyle = "#2c3e50";
  ctx.font = "bold 22px Segoe UI";
  ctx.textAlign = "center";
  ctx.fillText("SCRATCH HERE", canvas.width / 2, canvas.height / 2);

  let scratching = false;
  let revealed = false;

  function scratch(x, y) {
    ctx.globalCompositeOperation = "destination-out";
    ctx.beginPath();
    ctx.arc(x, y, 30, 0, Math.PI * 2);
    ctx.fill();
  }

  function checkReveal() {
    if (revealed) return;

    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    let cleared = 0;

    for (let i = 3; i < imageData.data.length; i += 4) {
      if (imageData.data[i] === 0) cleared++;
    }

    const percent = (cleared / (canvas.width * canvas.height)) * 100;

    if (percent > 35) {
      revealed = true;
      canvas.style.transition = "opacity 0.6s ease";
      canvas.style.opacity = 0;
      setTimeout(() => canvas.remove(), 600);
      document.getElementById("result").style.display = "block";
    }
  }

  canvas.addEventListener("mousedown", () => scratching = true);
  canvas.addEventListener("mouseup", () => scratching = false);
  canvas.addEventListener("mouseleave", () => scratching = false);

  canvas.addEventListener("mousemove", (e) => {
    if (!scratching) return;
    const rect = canvas.getBoundingClientRect();
    scratch(e.clientX - rect.left, e.clientY - rect.top);
    checkReveal();
  });

  canvas.addEventListener("touchstart", () => scratching = true);
  canvas.addEventListener("touchend", () => scratching = false);

  canvas.addEventListener("touchmove", (e) => {
    e.preventDefault();
    if (!scratching) return;
    const rect = canvas.getBoundingClientRect();
    const touch = e.touches[0];
    scratch(touch.clientX - rect.left, touch.clientY - rect.top);
    checkReveal();
  }, { passive: false });
</script>

</body>
</html>
